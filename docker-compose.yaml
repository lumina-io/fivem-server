version: "3.9"
networks:
  fivem:
    external: true
services:
  fivem:
    image: ghcr.io/laica-lunasys/fivem-server:latest
    container_name: "fivem-server"
    restart: "unless-stopped"
    ports:
      - "30120:30120"
      - "30120:30120/udp"
      - "40120:40120"
    volumes:
      - ./local/txData:/app/fivem/txData
    environment:
      TZ: "Asia/Tokyo"
      # !!!
      # IF YOU WANT MOUNT VOLUMES,
      # UID/GID MUST BE Provide!!! (for directory / files permission)
      # !!!
      UID: "${USER_ID:-0}"
      GID: "${GROUP_ID:-0}"
      TXADMIN_PORT: 40120
    networks:
      - fivem

  mariadb:
    image: mariadb:11.0.3
    container_name: "fivem-mariadb"
    restart: "unless-stopped"
    ports:
      - "3306:3306"
    volumes:
      - ./local/mysql:/var/lib/mysql
    environment:
      TZ: "Asia/Tokyo"
      # !!!
      # IF YOU WANT MOUNT VOLUMES,
      # UID/GID MUST BE Provide!!! (for directory / files permission)
      # !!!
      UID: "${USER_ID:-0}"
      GID: "${GROUP_ID:-0}"
      MARIADB_ROOT_PASSWORD: "${MARIADB_ROOT_PASSWORD}"
      MARIADB_DATABASE: "${MARIADB_DATABASE}"
      MARIADB_USER: "${MARIADB_USER}"
      MARIADB_PASSWORD: "${MARIADB_PASSWORD}"
    # Copy-pasted from https://github.com/docker-library/mariadb/issues/94
    #healthcheck:
    #  test: ["CMD", "mysqladmin", "ping", "--silent",  "--user", "${MARIADB_USER}", "--password", "${MARIADB_PASSWORD}"]
    networks:
      - fivem
